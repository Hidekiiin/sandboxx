<!DOCTYPE html>
<html>
<head>
  <title>p5.js Game</title>
  <!-- p5.js „Çí CDN „ÅßË™≠„ÅøËæº„ÇÄ -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
  <style>
    body {
      margin: 0;
      overflow: hidden;
    }
  </style>
</head>
<body>
  <script>
    // üéÆ „Ç≤„Éº„É†Â§âÊï∞
    let ball;
    let gravity = 0.6;
    let lift = -12;
    let obstacles = [];
    let score = 0;

    // üéÆ „Éú„Éº„É´„ÇØ„É©„Çπ
    class Ball {
      constructor() {
        this.x = 50;
        this.y = height / 2;
        this.r = 20;
        this.speed = 0;
      }

      jump() {
        this.speed = lift;
      }

      update() {
        this.speed += gravity;
        this.y += this.speed;

        if (this.y > height - this.r) {
          this.y = height - this.r;
          this.speed = 0;
        }
        if (this.y < this.r) {
          this.y = this.r;
          this.speed = 0;
        }
      }

      show() {
        fill(255, 0, 0);
        ellipse(this.x, this.y, this.r * 2);
      }
    }

    // üéÆ ÈöúÂÆ≥Áâ©„ÇØ„É©„Çπ
    class Obstacle {
      constructor() {
        this.x = width;
        this.y = height - 40;
        this.w = 40;
        this.h = 40;
        this.speed = 6;
      }

      move() {
        this.x -= this.speed;
      }

      show() {
        fill(0, 255, 0);
        rect(this.x, this.y, this.w, this.h);
      }

      offscreen() {
        return this.x < -this.w;
      }

      hits(ball) {
        return (
          ball.y + ball.r > this.y &&
          ball.x + ball.r > this.x &&
          ball.x - ball.r < this.x + this.w
        );
      }
    }

    // üéÆ „Ç≤„Éº„É†ÂàùÊúüÂåñ
    function setup() {
      createCanvas(window.innerWidth, window.innerHeight);
      ball = new Ball();
    }

    // üéÆ „É°„Ç§„É≥„É´„Éº„Éó
    function draw() {
      background(135, 206, 250);

      // „Çπ„Ç≥„Ç¢Ë°®Á§∫
      fill(0);
      textSize(24);
      text(`üèÜ „Çπ„Ç≥„Ç¢: ${score}`, 10, 30);

      ball.update();
      ball.show();

      // ÈöúÂÆ≥Áâ©ÁîüÊàê
      if (frameCount % 80 === 0) {
        obstacles.push(new Obstacle());
      }

      // ÈöúÂÆ≥Áâ©Ë°®Á§∫ & Ë°ùÁ™ÅÂà§ÂÆö
      for (let i = obstacles.length - 1; i >= 0; i--) {
        obstacles[i].move();
        obstacles[i].show();

        if (obstacles[i].hits(ball)) {
          console.log('üí• „Ç≤„Éº„É†„Ç™„Éº„Éê„ÉºÔºÅ');
          noLoop(); // „Ç≤„Éº„É†ÂÅúÊ≠¢
        }

        if (obstacles[i].offscreen()) {
          obstacles.splice(i, 1);
          score++;
        }
      }
    }

    // üéÆ „Çπ„Éö„Éº„Çπ„Ç≠„Éº„Åß„Ç∏„É£„É≥„Éó
    function keyPressed() {
      if (key === ' ') {
        ball.jump();
      }
    }
  </script>
</body>
</html>
